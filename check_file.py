import pandas as pd

# Проверяем файл DFASDF_звонки.xlsx
print("Проверка файла DFASDF_звонки.xlsx")
try:
    df = pd.read_excel('DFASDF_звонки.xlsx')
    print("Успешно прочитан файл")
    print(f"Количество строк: {len(df)}")
    print(f"Столбцы: {df.columns.tolist()}")
    
    # Проверяем есть ли нужные столбцы
    if 'Ссылка на запись' in df.columns:
        print(f"Столбец 'Ссылка на запись' присутствует, всего заполненных: {df['Ссылка на запись'].notna().sum()}")
        # Проверяем первые 3 ссылки
        links = df['Ссылка на запись'].dropna().head(3).tolist()
        print(f"Примеры ссылок: {links}")
    else:
        print("ОШИБКА! Столбец 'Ссылка на запись' отсутствует!")
        
    if 'Транскрибация' in df.columns:
        print(f"Столбец 'Транскрибация' присутствует")
        
        # Проверяем, сколько значений равны '-'
        dash_count = (df['Транскрибация'] == '-').sum()
        print(f"Количество значений '-' в столбце 'Транскрибация': {dash_count}")
        
        # Проверяем другие возможные пустые значения
        empty_count = df['Транскрибация'].isna().sum()
        print(f"Количество пустых значений в столбце 'Транскрибация': {empty_count}")
        
        empty_string_count = (df['Транскрибация'] == '').sum()
        print(f"Количество пустых строк в столбце 'Транскрибация': {empty_string_count}")
        
        # Вывести уникальные значения для анализа
        unique_values = df['Транскрибация'].unique()
        print(f"Уникальные значения в столбце 'Транскрибация': {[str(x) for x in unique_values[:5]]}")
    else:
        print("ОШИБКА! Столбец 'Транскрибация' отсутствует!")
        
except Exception as e:
    print(f"Ошибка при чтении файла: {e}")

print("\n\nПроверка файла DFASDF.xlsx (текущий рабочий файл)")
try:
    df = pd.read_excel('DFASDF.xlsx')
    print("Успешно прочитан файл")
    print(f"Количество строк: {len(df)}")
    print(f"Столбцы: {df.columns.tolist()}")
    
    # Проверяем есть ли нужные столбцы
    if 'Ссылка на запись' in df.columns:
        print(f"Столбец 'Ссылка на запись' присутствует, всего заполненных: {df['Ссылка на запись'].notna().sum()}")
        # Проверяем первые 3 ссылки
        links = df['Ссылка на запись'].dropna().head(3).tolist()
        print(f"Примеры ссылок: {links}")
    else:
        print("ОШИБКА! Столбец 'Ссылка на запись' отсутствует!")
        
    if 'Транскрибация' in df.columns:
        print(f"Столбец 'Транскрибация' присутствует")
        
        # Проверяем, сколько значений равны '-'
        dash_count = (df['Транскрибация'] == '-').sum()
        print(f"Количество значений '-' в столбце 'Транскрибация': {dash_count}")
        
        # Проверяем другие возможные пустые значения
        empty_count = df['Транскрибация'].isna().sum()
        print(f"Количество пустых значений в столбце 'Транскрибация': {empty_count}")
        
        empty_string_count = (df['Транскрибация'] == '').sum()
        print(f"Количество пустых строк в столбце 'Транскрибация': {empty_string_count}")
        
        # Вывести уникальные значения для анализа
        unique_values = df['Транскрибация'].unique()
        print(f"Уникальные значения в столбце 'Транскрибация': {[str(x) for x in unique_values[:5]]}")
    else:
        print("ОШИБКА! Столбец 'Транскрибация' отсутствует!")
        
except Exception as e:
    print(f"Ошибка при чтении файла: {e}") 